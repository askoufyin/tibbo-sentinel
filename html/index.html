<!DOCTYPE html>
<?

#include "global.th"
#include "utils.th"
#include "sensors_db.th"
#include "device_funcs.th"


extern unsigned short sensor_count;
extern unsigned short unknown_sensor_count;
extern sensor *connected_sensors;


connected_sensors = device_boot_portscan(&sensor_count, &unknown_sensor_count);


?>
<html>
<head>
<title>Welcome</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="style.css" />
<link rel="stylesheet" type="text/css" href="swal2.css" /> 
<script type="text/javascript" src="jq.js"></script>
<script type="text/javascript" src="jqbm.js"></script>
<script type="text/javascript" src="swal2.js"></script>
<script type="text/javascript" src="ma.js"></script>
</head>
<body>
<div class="body_outer">
    <div class="heading">
        <div class="main_heading">Welcome</div>
        <div class="main_heading_descr">This is main page of the device configuration menu</div>
    </div>
    <div class="body">
		<? 
			if(unknown_sensor_count > 0) {
		?>
				<div class="msg" style="float: none; margin-bottom: 1em;"><? sock_send(str(unknown_sensor_count)); ?> new sensor(s) connected. Please visit <a href="device_learn.html">Learn Sensors</a> page.</div>
		<?
			}
		?>
		<div class="banner_flex_outer">
			<div class="banner" style="background-image: url(network.svg)">
				<a class="banner_link" href="network_settings.html">Network Settings</a>
				<div class="banner_info">Configure network connectivity settings, device name, etc.</div>
			</div>
			
			<div class="banner" style="background-image: url(security.svg)">
				<a class="banner_link" href="security.html">Security</a>
				<div class="banner_info">Set device password, configure list of hosts that can access this device and more</div>
			</div>

			<div class="banner" style="background-image: url(ag.svg)">
				<a class="banner_link" href="aggregate_settings.html">AggreGate&trade; Settings</a>
				<div class="banner_info">Enable seamless integration with AggreGate&trade; SCADA platform</div>
			</div>

			<div class="banner">
				<a class="banner_link" href="device_learn.html">Learn Sensors</a>
				<div class="banner_info">Connect new sensors and teach device to distinguish it from each other</div>
			</div>

			<div class="banner">
				<a class="banner_link" href="message_templates.html">Message Templates</a>
				<div class="banner_info">Define message text and list of recipients for SMS and E-mail notifications</div>
			</div>

			<div class="banner">
				<a class="banner_link" href="notifications.html">Notifications</a>
				<div class="banner_info">Setup SMTP protocol, specify SMS parameters and options</div>
			</div>

			<div class="banner" style="background-image: url(bell.svg)">
				<a class="banner_link" href="margins_and_actions.html">Margins, Alarms & Actions</a>
				<div class="banner_info">Configure acceptable ranges of sensor data, setup alarms and actions taken when monitored data goes out of range</div>
			</div>

			<div class="banner">
				<a class="banner_link" href="dc_ports.html">Port Setup</a>
				<div class="banner_info">Configure sensors connected to dry contact, 1-Wire and I<sup>2</sup>C ports</div>
			</div>

			<div class="banner" style="background-image: url(export.svg)">
				<a class="banner_link" href="data_export.html">SNMP and Data Export</a>
				<div class="banner_info">Configure sensor data acquishion via SNMP, XML file, proprietary protocols or other methods</div>
			</div>

			<div class="banner" style="background-image: url(monitor.svg)">
				<a class="banner_link" href="monitor.html">Monitor Sensors</a>
				<div class="banner_info">View and monitor values reported by sensors</div>
			</div>

			<div class="banner" style="background-image: url(backup_restore.svg)">
				<a class="banner_link" href="backup_restore.html">Backup & Restore</a>
				<div class="banner_info">Backup and restore device configuration</div>
			</div>
		</div>
		
		<div class="footer">&copy; 2015-2016 <a href="http://tibbo.com" target="_blank">Tibbo Technology</a>
		<span class="spl">HW version: <?
			sock.setdata(htmlspecialchars(sys.version));
			sock.send();
		?></span>
		<span class="spl">FW version: <? echo(__VERSION__); ?></span>
		<span class="spl">Sensor DB version: 1.0</span>
		<span class="spl"><strong><? sock_send(str(sensor_count+unknown_sensor_count)); ?></strong> sensor(s) connected</span>
		</div>
		<!--</div>-->
	</div>
</div>

<script type="text/javascript">
$(document).ready(function() {
	var msg = $(".msg");
	if(undefined !== msg)
		msg.fadeIn();
});
</script>

</body>
</html>
<? sock.send(); ?>